* BUG: crash on leaving the map (something broken with the position cache)
* Don't remove an entity in `kill_entity` on fadeout (see TODO)
* Add proper keycodes/enums
* Add generic is_key_pressed function
* Split utils into individual files
* Split systems into individual files
* graphical effect of high/withdrawn
  - use tcod::console_set_fade for low (instead of changing the blitting fade
    value)
  - though that would fade the GUI as well...
* background glow for the irresistible area around a dose
* bonuses on superhigh
  - see entities on som >= 98
  - uncover the entire map on som == 99
* improve level generator not to create blocked entities
* add different levels

* BUG: the game is a bit jerky sometimes
  - doesn't seem to be a (purely) AI thing. Even when we replaced AI for a
  random destination the problem persisted.
  - when we set AI to just always wait, the hangs were still occasionally there.
  They could have been rarer, but they also just may have been harder to notice
  (because the only thing moving was the player)
* wrap tcod::console_t if feasible
* replace Map with Position caching on the ComponentManager level


* write a generic system interface so we can simplify the `update` function.
* write a defsystem macro that handles the system boilerplate?
* add the entity id in the Map as a generic type
  - maybe do the same for position?
  - This requires the extern callback to tcod_find_path_using_function to be
  generic (because the map is generic and we need to cast the `*void user_data`
   to `Map<T>`) and that's hitting a compiler bug.






Notes on tcod:

Fade the entire screen in/out of a colour:
     tcod::console_set_fade(fade: u8, tcod::Color)
     (`fade` is <0, 255>, `Color` is the colour to fade from/to)

(great on death, etc.)


The tcod background flags are confusing and at least in my experiments not
    particularly functional. Just use:

    `tcod::console_put_char_ex` which lets you directly specify both foreground
    and background colours and dosen't use the background flags at all.

There doesn't seem to be a way to mix two cells together, i.e. have a proper
disappearing fade. To do that, we'd probably have to invoke some SDL, or just
switch away from TCOD. Seems to be a limitation of the library. Or as a
kinda-solution, don't use dots for background walkable tiles and instead use a
coloured spaces or something.

I kinda like dots, though. They work better at figuring the distances --
especially wrt diagonals.
